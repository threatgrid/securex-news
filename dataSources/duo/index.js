const Parser = require("rss-parser");

/**
 * Fetch RSS from US CERT Current Activity and convert to JSON.
 * @return {Object}
 */
exports.getNews = async () => {
  const parser = new Parser();
  try {
    const rawNews = await parser.parseURL("https://duo.com/decipher/feed");

    return {
      items: rawNews.items.map((x) => ({
        title: x.title,
        link: x.link,
        date: x.isoDate,
        summary: x.contentSnippet.substr(0, 500) + "...",
        sourceId: "DUO",
      })),
      sources: {
        DUO: {
          icon:
            "data:image/png;base64,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",
          name: "DUO",
          "color-dusk": "#6DBF51",
          "color-light": "#6DBF51",
        },
      },
    };
  } catch (err) {
    return [];
  }
};
